"use strict";(self.webpackChunkgrafana_metricsdrilldown_app=self.webpackChunkgrafana_metricsdrilldown_app||[]).push([[601],{2601:(e,t,r)=>{r.r(t),r.d(t,{calculateOutlierValue:()=>d,sortSeries:()=>c,sortSeriesByName:()=>p,wasmSupported:()=>v});var n=r(6944),o=r(7781),l=r(3241),s=r(3347),a=r(5570);const c=(0,l.memoize)(((e,t,r="asc")=>{if("alphabetical"===t)return p(e,"asc");if("alphabetical-reversed"===t)return p(e,"desc");"outliers"===t&&u(e);const n=r=>{var n;try{if("outliers"===t)return d(e,r)}catch(e){console.error(e),t=o.ReducerID.stdDev}const l=o.fieldReducers.get(t);var s;var a;return null!==(a=(null!==(s=null===(n=l.reduce)||void 0===n?void 0:n.call(l,r.fields[1],!0,!0))&&void 0!==s?s:(0,o.doStandardCalcs)(r.fields[1],!0,!0))[t])&&void 0!==a?a:0},l=e.map((e=>({value:n(e),dataFrame:e})));return l.sort(((e,t)=>void 0!==e.value&&void 0!==t.value?t.value-e.value:0)),"asc"===r&&l.reverse(),l.map((({dataFrame:e})=>e))}),((e,t,r="asc")=>{const n=i(e)?e[0].fields[0].values[0]:0,o=i(e)?e[e.length-1].fields[0].values[e[e.length-1].fields[0].values.length-1]:0;return`${e.length>0?(0,a.H)(e[0]):""}_${e.length>0?(0,a.H)(e[e.length-1]):""}_${n}_${o}_${e.length}_${t}_${r}`}));function i(e){return e.length>0&&e[0].fields.length>0&&e[0].fields[0].values.length>0}const u=e=>{if(!v())return;const t=(0,o.outerJoinDataFrames)({frames:e});if(!t)return;const r=t.fields.filter((e=>e.type===o.FieldType.number)).map((e=>new Float64Array(e.values)));try{const e=n.OutlierDetector.dbscan({sensitivity:.4}).preprocess(r);f=e.detect()}catch(e){console.error(e),f=void 0}};let f;const d=(e,t)=>{if(!v())throw new Error("WASM not supported, fall back to stdDev");if(!f)throw new Error("Initialize outlier detector first");const r=e.indexOf(t);return f.seriesResults[r].isOutlier?-f.seriesResults[r].outlierIntervals.length:0},p=(e,t)=>{const r=[...e];return r.sort(((e,t)=>{const r=(0,a.H)(e),n=(0,a.H)(t);return r&&n&&null!==(o=null==r?void 0:r.localeCompare(n))&&void 0!==o?o:0;var o})),"desc"===t&&r.reverse(),r},v=()=>{const e="object"==typeof WebAssembly;return e||(0,s.z)("wasm_not_supported",{}),e}},3347:(e,t,r)=>{r.d(t,{h:()=>f,z:()=>i});var n=r(8531),o=r(4137),l=r(5176);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const c="grafana_explore_metrics_";function i(e,t){(0,n.reportInteraction)(`${c}${e}`,a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){s(e,t,r[t])}))}return e}({},t),{meta:{appRelease:n.config.apps[o.s_].version,appVersion:l.t}}))}function u(e,t){i("label_filter_changed",{label:e,action:t,cause:"adhoc_filter"})}function f(e,t){e.length===t.length?function(e,t){for(const r of t)for(const t of e)r.key===t.key&&r.value!==t.value&&u(r.key,"changed")}(e,t):e.length<t.length?function(e,t){for(const r of t)e.some((e=>e.key===r.key))||u(r.key,"removed")}(e,t):function(e,t){for(const r of e)!t.some((e=>e.key===r.key))&&u(r.key,"added")}(e,t)}},5570:(e,t,r)=>{function n(e){var t;const r=null===(t=e.fields[1])||void 0===t?void 0:t.labels;if(!r)return null;const n=Object.keys(r);return 0===n.length?null:r[n[0]]}r.d(t,{H:()=>n})}}]);
//# sourceMappingURL=601.js.map?_cache=8428bc624bdf66c69823