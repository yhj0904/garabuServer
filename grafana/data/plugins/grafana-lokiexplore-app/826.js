"use strict";(self.webpackChunkgrafana_lokiexplore_app=self.webpackChunkgrafana_lokiexplore_app||[]).push([[826],{6826:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P,updatePlugin:()=>O});var r=n(5959),a=n.n(r),i=n(6089),l=n(3241),o=n(1269),c=n(7781),u=n(8531),s=n(2007),d=n(5953),p=n(4351);function m(e,t,n,r,a,i,l){try{var o=e[i](l),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(r,a)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function l(e){m(i,r,a,l,o,"next",e)}function o(e){m(i,r,a,l,o,"throw",e)}l(void 0)}))}}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){f(e,t,n[t])}))}return e}function b(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const h=e=>({colorWeak:i.css`
    color: ${e.colors.text.secondary};
  `,icon:(0,i.css)({marginLeft:e.spacing(1)}),label:(0,i.css)({alignItems:"center",display:"flex",marginBottom:e.spacing(.75)}),marginTop:i.css`
    margin-top: ${e.spacing(3)};
  `,marginTopXl:i.css`
    margin-top: ${e.spacing(6)};
  `}),y=function(){var e=v((function*(e,t){try{yield O(e,t),u.locationService.reload()}catch(e){d.v.error(e,{msg:"Error while updating the plugin"})}}));return function(t,n){return e.apply(this,arguments)}}(),w={appConfig:{container:"data-testid ac-container",datasource:"data-testid ac-datasource-input",interval:"data-testid ac-interval-input",submit:"data-testid ac-submit-form"}},O=function(){var e=v((function*(e,t){const n=(0,u.getBackendSrv)().fetch({data:t,method:"POST",url:`/api/plugins/${e}/settings`});return(yield(0,o.lastValueFrom)(n)).data}));return function(t,n){return e.apply(this,arguments)}}(),S=e=>{try{if(e){const t=c.rangeUtil.intervalToSeconds(e);return(0,l.isNumber)(t)&&t>=3600}return!0}catch(e){}return!1},P=({plugin:e})=>{const t=(0,s.useStyles2)(h),{enabled:n,jsonData:i,pinned:l}=e.meta;var o,c,d,m,v;const[f,O]=(0,r.useState)({dataSource:null!==(d=null!==(c=null!==(o=null==i?void 0:i.dataSource)&&void 0!==o?o:(0,p.x0)())&&void 0!==c?c:(0,p.QB)())&&void 0!==d?d:"",interval:null!==(m=null==i?void 0:i.interval)&&void 0!==m?m:"",isValid:S(null!==(v=null==i?void 0:i.interval)&&void 0!==v?v:"")});return a().createElement("div",{"data-testid":w.appConfig.container},a().createElement(s.FieldSet,{label:"Settings"},a().createElement(s.Field,{description:a().createElement("span",null,"The default data source to be used for new Logs Drilldown users. Each user can override their default by setting another data source in Logs Drilldown."),label:"Default data source"},a().createElement(u.DataSourcePicker,{width:60,filter:e=>"loki"===e.type,current:f.dataSource,onChange:e=>{O(b(g({},f),{dataSource:e.uid}))}})),a().createElement(s.Field,{invalid:!S(f.interval),error:'Interval is invalid. Please enter an interval longer then "60m". For example: 3d, 1w, 1m',description:a().createElement("span",null,"The maximum interval that can be selected in the time picker within the Grafana Logs Drilldown app. If empty, users can select any time range interval in Grafana Logs Drilldown. ",a().createElement("br",null),"Example values: 7d, 24h, 2w"),label:"Maximum time picker interval",className:t.marginTop},a().createElement(s.Input,{width:60,id:"interval","data-testid":w.appConfig.interval,label:"Max interval",value:null==f?void 0:f.interval,placeholder:"7d",onChange:e=>{const t=e.target.value.trim();O(b(g({},f),{interval:t,isValid:S(t)}))}})),a().createElement("div",{className:t.marginTop},a().createElement(s.Button,{type:"submit","data-testid":w.appConfig.submit,onClick:()=>y(e.meta.id,{enabled:n,jsonData:{dataSource:f.dataSource,interval:f.interval},pinned:l}),disabled:!S(f.interval)},"Save settings"))))}}}]);
//# sourceMappingURL=826.js.map?_cache=6564b74ba9a88748417c